# ğŸ¾ PetBrain

**å‘Šåˆ«å…»ç‹—è¿·èŒ«ï¼Œæ„Ÿå—çº¯ç²¹é™ªä¼´**

PetBrain æ˜¯ä¸€ä¸ªä¸ºæ–°æ‰‹å…»å® è€…è®¾è®¡çš„ AI é™ªä¼´åº”ç”¨ï¼Œä»é€‰ç‹—åˆ°åˆ°å®¶ 30 å¤©ï¼Œå…¨ç¨‹é™ªä¼´ä½ çš„å…»å® ä¹‹æ—…ã€‚

ğŸŒ **åœ¨çº¿ä½“éªŒï¼š** [https://petbrain.vercel.app](https://petbrain.vercel.app)

---

## âœ¨ æ ¸å¿ƒåŠŸèƒ½

### ğŸ” æ¢ç´¢é˜¶æ®µ - å…»ç‹—å‰å’¨è¯¢
- AI å¯¹è¯å’¨è¯¢ï¼Œå¸®åŠ©ä½ äº†è§£ä¸åŒçŠ¬ç§ç‰¹æ€§
- è¯„ä¼°ä½ çš„ç”Ÿæ´»æ–¹å¼æ˜¯å¦é€‚åˆå…»ç‹—
- å®æ—¶å¯¹è¯è®°å¿†ï¼ŒæŒç»­æ·±å…¥è®¨è®º

### ğŸ“‹ å‡†å¤‡é˜¶æ®µ - æœ‰åºå‡†å¤‡
- ä¸ªæ€§åŒ–å‡†å¤‡æ¸…å•ç”Ÿæˆ
- Markdown æ ¼å¼æ¸²æŸ“ï¼Œæ¸…æ™°æ˜“è¯»
- å¯¹è¯å†å²æŒä¹…åŒ–ï¼Œéšæ—¶æŸ¥çœ‹

### ğŸ  é™ªä¼´é˜¶æ®µ - 30å¤©é€‚åº”æœŸ
- åŸºäºç‹—ç‹—ä¿¡æ¯çš„ä¸ªæ€§åŒ–å»ºè®®
- æ¯æ—¥å…³æ³¨å¡ç‰‡ï¼ˆä»Šå¤©è¯¥åšä»€ä¹ˆã€ä¸è¯¥åšä»€ä¹ˆï¼‰
- å®æ—¶ AI é™ªä¼´ï¼Œè§£ç­”å…»å® ç–‘é—®
- åˆ°å®¶å¤©æ•°è‡ªåŠ¨è®¡ç®—ï¼Œè§è¯æˆé•¿

---

## ğŸ› ï¸ æŠ€æœ¯æ ˆ

### å‰ç«¯æ¡†æ¶
- **Next.js 16.1.1** - React æ¡†æ¶ï¼ˆApp Routerï¼‰
- **TypeScript** - ç±»å‹å®‰å…¨
- **Tailwind CSS** - åŸå­åŒ– CSS

### UI è®¾è®¡ç†å¿µ
- **Calm Tech** - å¹³é™æŠ€æœ¯ï¼Œä¸æ‰“æ‰°çš„é™ªä¼´
- **Soft Brutalism** - æŸ”å’Œç²—é‡ä¸»ä¹‰ï¼ˆ24px åœ†è§’ + 1.5px è¾¹æ¡†ï¼‰
- **Bento Grid** - ä¾¿å½“ç›’å¼å¡ç‰‡å¸ƒå±€

### æ ¸å¿ƒä¾èµ–
- **react-markdown** - Markdown æ¸²æŸ“
- **@supabase/supabase-js** - æ•°æ®åº“å’Œå­˜å‚¨
- **Dify AI** - AI å¯¹è¯èƒ½åŠ›

### æ•°æ®å±‚
- **Supabase** - PostgreSQL æ•°æ®åº“
  - ç”¨æˆ·ç®¡ç†ï¼ˆåŒ¿åç”¨æˆ·ï¼‰
  - ç‹—ç‹—ä¿¡æ¯å­˜å‚¨
  - æ¯æ—¥å¡ç‰‡ç¼“å­˜
- **localStorage** - æœ¬åœ°é™çº§æ–¹æ¡ˆ
  - å¯¹è¯å†å²æŒä¹…åŒ–
  - ç¦»çº¿æ•°æ®ç¼“å­˜

### éƒ¨ç½²
- **Vercel** - è‡ªåŠ¨åŒ–éƒ¨ç½²å’Œå…¨çƒ CDN
- **GitHub** - ä»£ç æ‰˜ç®¡å’Œç‰ˆæœ¬æ§åˆ¶

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. å…‹éš†é¡¹ç›®

```bash
git clone https://github.com/m2hl2595/petbrain.git
cd petbrain
```

### 2. å®‰è£…ä¾èµ–

```bash
npm install
```

### 3. é…ç½®ç¯å¢ƒå˜é‡

å¤åˆ¶ `.env.local` æ–‡ä»¶å¹¶å¡«å…¥ä½ çš„é…ç½®ï¼š

```bash
# åº”ç”¨é…ç½®
NEXT_PUBLIC_APP_NAME=PetBrain
NEXT_PUBLIC_APP_URL=http://localhost:3000

# Supabase é…ç½®
NEXT_PUBLIC_SUPABASE_URL=your_supabase_url
NEXT_PUBLIC_SUPABASE_ANON_KEY=your_supabase_anon_key

# Dify AI é…ç½®
DIFY_EXPLORE_API_KEY=your_explore_api_key
DIFY_PREP_API_KEY=your_prep_api_key
DIFY_WITHDOG_API_KEY=your_withdog_api_key
DIFY_API_URL=https://api.dify.ai/v1
```

è¯¦ç»†é…ç½®è¯´æ˜è§ [éƒ¨ç½²æŒ‡å—](#-éƒ¨ç½²æŒ‡å—)ã€‚

### 4. å¯åŠ¨å¼€å‘æœåŠ¡å™¨

```bash
npm run dev
```

è®¿é—® [http://localhost:3000](http://localhost:3000) æŸ¥çœ‹åº”ç”¨ã€‚

---

## ğŸ“ é¡¹ç›®ç»“æ„

```
petbrain/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ app/                      # Next.js App Router
â”‚   â”‚   â”œâ”€â”€ page.tsx              # é¦–é¡µï¼ˆBento å¡ç‰‡å¸ƒå±€ï¼‰
â”‚   â”‚   â”œâ”€â”€ explore/              # æ¢ç´¢é˜¶æ®µé¡µé¢
â”‚   â”‚   â”œâ”€â”€ prep/                 # å‡†å¤‡é˜¶æ®µé¡µé¢
â”‚   â”‚   â”œâ”€â”€ with-dog/             # é™ªä¼´é˜¶æ®µé¡µé¢
â”‚   â”‚   â””â”€â”€ api/                  # API è·¯ç”±
â”‚   â”‚       â”œâ”€â”€ chat/             # Explore å¯¹è¯ API
â”‚   â”‚       â”œâ”€â”€ prep-chat/        # Prep å¯¹è¯ API
â”‚   â”‚       â””â”€â”€ with-dog-chat/    # With-Dog å¯¹è¯ API
â”‚   â”œâ”€â”€ components/               # React ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ BentoStageCard.tsx    # Bento é˜¶æ®µå¡ç‰‡
â”‚   â”‚   â”œâ”€â”€ ChatMessageBubble.tsx # èŠå¤©æ°”æ³¡ï¼ˆMarkdown æ¸²æŸ“ï¼‰
â”‚   â”‚   â”œâ”€â”€ ChatInputArea.tsx     # èŠå¤©è¾“å…¥æ¡†
â”‚   â”‚   â”œâ”€â”€ DogInfoForm.tsx       # ç‹—ç‹—ä¿¡æ¯è¡¨å•
â”‚   â”‚   â”œâ”€â”€ DogInfoModal.tsx      # ç‹—ç‹—ä¿¡æ¯å¼¹çª—
â”‚   â”‚   â”œâ”€â”€ DailyFocusCard.tsx    # æ¯æ—¥å…³æ³¨å¡ç‰‡
â”‚   â”‚   â”œâ”€â”€ DailyCardOverlay.tsx  # å¡ç‰‡è¦†ç›–å±‚
â”‚   â”‚   â””â”€â”€ DailyCardBentoTab.tsx # å¡ç‰‡æ‚¬æµ®æ ‡ç­¾
â”‚   â””â”€â”€ lib/                      # å·¥å…·å‡½æ•°
â”‚       â”œâ”€â”€ supabase.ts           # Supabase å®¢æˆ·ç«¯
â”‚       â”œâ”€â”€ storage.ts            # localStorage å°è£…
â”‚       â””â”€â”€ dogInfoExtractor.ts   # ç‹—ç‹—ä¿¡æ¯æå–å™¨
â”œâ”€â”€ public/                       # é™æ€èµ„æº
â”œâ”€â”€ .env.local                    # ç¯å¢ƒå˜é‡ï¼ˆä¸æäº¤ï¼‰
â”œâ”€â”€ package.json                  # ä¾èµ–é…ç½®
â”œâ”€â”€ tailwind.config.ts            # Tailwind é…ç½®
â””â”€â”€ tsconfig.json                 # TypeScript é…ç½®
```

---

## ğŸ¯ æ ¸å¿ƒç‰¹æ€§è¯´æ˜

### 1. å¯¹è¯è®°å¿†ç®¡ç†

æ¯ä¸ªé˜¶æ®µéƒ½ä½¿ç”¨ Dify çš„ `conversation_id` æœºåˆ¶å®ç°å¯¹è¯è®°å¿†ï¼š

```typescript
// API è°ƒç”¨æ—¶ä¼ é€’ conversation_id
const response = await fetch('/api/chat', {
  method: 'POST',
  body: JSON.stringify({
    query: userMessage,
    conversation_id: conversationId, // ç»´æŒä¸Šä¸‹æ–‡
  }),
});
```

### 2. æ•°æ®æŒä¹…åŒ–ç­–ç•¥

é‡‡ç”¨ **Supabase + localStorage åŒå†™** ç­–ç•¥ï¼š

```typescript
// 1. å…ˆä¿å­˜åˆ° localStorageï¼ˆç«‹å³åé¦ˆï¼‰
localStorage.setItem('petbrain_dog_info', JSON.stringify(data));

// 2. æ›´æ–° UI
setDogInfo(data);

// 3. å¼‚æ­¥ä¿å­˜åˆ° Supabase
await saveToSupabase(userId, data);
```

### 3. æ—¥æœŸéªŒè¯æ—¶åŒºå¤„ç†

ä½¿ç”¨æœ¬åœ°æ—¶åŒºè€Œé UTCï¼Œé¿å…æ—¥æœŸé€‰æ‹©å™¨é”™è¯¯ï¼š

```typescript
const formatLocalDate = (date: Date): string => {
  const year = date.getFullYear();
  const month = String(date.getMonth() + 1).padStart(2, '0');
  const day = String(date.getDate()).padStart(2, '0');
  return `${year}-${month}-${day}`;
};
```

### 4. æ€§èƒ½ä¼˜åŒ–

ä½¿ç”¨ `next/dynamic` æ‡’åŠ è½½å¤§å‹ç»„ä»¶ï¼š

```typescript
const DogInfoModal = dynamic(() => import('@/components/DogInfoModal'), {
  ssr: false,
});
```

---

## ğŸ“‹ éƒ¨ç½²æŒ‡å—

### Vercel éƒ¨ç½²ï¼ˆæ¨èï¼‰

1. **Fork æœ¬é¡¹ç›®åˆ°ä½ çš„ GitHub**

2. **è®¿é—® [Vercel Dashboard](https://vercel.com/dashboard)**

3. **å¯¼å…¥é¡¹ç›®**
   - ç‚¹å‡» "Add New..." â†’ "Project"
   - é€‰æ‹©ä½ çš„ GitHub ä»“åº“

4. **é…ç½®ç¯å¢ƒå˜é‡**ï¼ˆå‚è€ƒ `.env.local`ï¼‰
   - æ‰€æœ‰ä»¥ `NEXT_PUBLIC_` å¼€å¤´çš„å˜é‡
   - Dify API Keys
   - Supabase è¿æ¥ä¿¡æ¯

5. **éƒ¨ç½²**
   - ç‚¹å‡» "Deploy" æŒ‰é’®
   - ç­‰å¾… 2-3 åˆ†é’Ÿè‡ªåŠ¨æ„å»ºå®Œæˆ

### Supabase æ•°æ®åº“é…ç½®

#### 1. åˆ›å»ºé¡¹ç›®

è®¿é—® [Supabase Dashboard](https://supabase.com/dashboard) åˆ›å»ºæ–°é¡¹ç›®ã€‚

#### 2. æ‰§è¡Œæ•°æ®åº“è¿ç§»

åœ¨ SQL Editor ä¸­æ‰§è¡Œä»¥ä¸‹ SQLï¼š

```sql
-- åˆ›å»º users è¡¨
CREATE TABLE users (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);

-- åˆ›å»º dog_info è¡¨
CREATE TABLE dog_info (
  user_id UUID PRIMARY KEY REFERENCES users(id),
  breed TEXT NOT NULL,
  age_months TEXT NOT NULL,
  companion_hours TEXT NOT NULL,
  home_date DATE NOT NULL,
  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
  updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);

-- åˆ›å»º daily_card è¡¨
CREATE TABLE daily_card (
  user_id UUID NOT NULL REFERENCES users(id),
  card_date DATE NOT NULL,
  focus TEXT NOT NULL,
  forbidden TEXT NOT NULL,
  reason TEXT NOT NULL,
  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
  PRIMARY KEY (user_id, card_date)
);
```

#### 3. é…ç½® RLS ç­–ç•¥ï¼ˆå¯é€‰ï¼‰

å¦‚æœéœ€è¦æ›´ç»†ç²’åº¦çš„æƒé™æ§åˆ¶ï¼Œå¯ä»¥é…ç½® Row Level Securityã€‚

### Dify AI é…ç½®

1. è®¿é—® [Dify.ai](https://dify.ai) åˆ›å»ºè´¦å·
2. åˆ›å»ºä¸‰ä¸ª AI åº”ç”¨ï¼š
   - **Explore App** - å…»ç‹—å‰å’¨è¯¢
   - **Prep App** - å‡†å¤‡é˜¶æ®µ
   - **With-Dog App** - é™ªä¼´é˜¶æ®µ
3. è·å–æ¯ä¸ªåº”ç”¨çš„ API Key å¹¶é…ç½®åˆ°ç¯å¢ƒå˜é‡

---

## ğŸ§‘â€ğŸ’» å¼€å‘æŒ‡å—

### ä»£ç è§„èŒƒ

é¡¹ç›®å·²é…ç½® ESLint å’Œ TypeScript ä¸¥æ ¼æ£€æŸ¥ï¼š

```bash
# è¿è¡Œ ESLint æ£€æŸ¥
npm run lint

# è¿è¡Œ TypeScript ç±»å‹æ£€æŸ¥
npx tsc --noEmit
```

### æ„å»ºç”Ÿäº§ç‰ˆæœ¬

```bash
npm run build
```

æ„å»ºäº§ç‰©ä½äº `.next` ç›®å½•ã€‚

### æœ¬åœ°é¢„è§ˆç”Ÿäº§ç‰ˆæœ¬

```bash
npm run build
npm start
```

---

## ğŸ› å¸¸è§é—®é¢˜

### 1. å¯¹è¯è®°å¿†ä¸¢å¤±ï¼Ÿ

**åŸå› ï¼š** `conversation_id` æœªæ­£ç¡®ä¼ é€’ç»™ APIã€‚

**è§£å†³æ–¹æ¡ˆï¼š** æ£€æŸ¥ API è·¯ç”±ä¸­æ˜¯å¦æ­£ç¡®æ¥æ”¶å¹¶ä¼ é€’ `conversation_id` å‚æ•°ã€‚

### 2. æ—¥æœŸé€‰æ‹©å™¨æ˜¾ç¤º"ä¸èƒ½æ™šäºä»Šå¤©"ï¼Ÿ

**åŸå› ï¼š** æ—¶åŒºé—®é¢˜ï¼Œä½¿ç”¨äº† UTC æ—¶é—´è€Œéæœ¬åœ°æ—¶é—´ã€‚

**è§£å†³æ–¹æ¡ˆï¼š** å·²åœ¨ `DogInfoForm.tsx` ä¸­ä½¿ç”¨ `formatLocalDate` å‡½æ•°ä¿®å¤ã€‚

### 3. Supabase ä¿å­˜å¤±è´¥ï¼Ÿ

**åŸå› ï¼š** æ•°æ®åº“è¡¨ç»“æ„æœªè¿ç§»æˆ– RLS ç­–ç•¥é…ç½®é”™è¯¯ã€‚

**è§£å†³æ–¹æ¡ˆï¼š**
- æ£€æŸ¥æ•°æ®åº“è¡¨æ˜¯å¦å­˜åœ¨ `home_date` åˆ—ï¼ˆè€Œéæ—§çš„ `days_home`ï¼‰
- æ£€æŸ¥ Supabase Dashboard â†’ Logs æŸ¥çœ‹è¯¦ç»†é”™è¯¯

### 4. ç¯å¢ƒå˜é‡ä¸ç”Ÿæ•ˆï¼Ÿ

**åŸå› ï¼š** Next.js éœ€è¦é‡å¯æ‰èƒ½è¯»å–æ–°çš„ç¯å¢ƒå˜é‡ã€‚

**è§£å†³æ–¹æ¡ˆï¼š** ä¿®æ”¹ `.env.local` åï¼Œé‡å¯å¼€å‘æœåŠ¡å™¨ï¼ˆ`npm run dev`ï¼‰ã€‚

---

## ğŸ“Š æŠ€æœ¯æŒ‡æ ‡

- âœ… **ESLint**: 0 é”™è¯¯ 0 è­¦å‘Š
- âœ… **TypeScript**: 100% ç±»å‹æ£€æŸ¥é€šè¿‡
- âœ… **æ„å»ºæ—¶é—´**: ~15 ç§’
- âœ… **é™æ€é¡µé¢**: 8 ä¸ªé¢„æ¸²æŸ“é¡µé¢
- âœ… **ä»£ç åˆ†å‰²**: æ‡’åŠ è½½å¼¹çª—ç»„ä»¶
- âœ… **ç”Ÿäº§éƒ¨ç½²**: Vercel å…¨çƒ CDN

---

## ğŸ“œ å¼€å‘å†ç¨‹

- **Day 1-10**: åŸºç¡€åŠŸèƒ½å®ç°
- **Day 11**: Supabase æ•°æ®åº“é›†æˆ
- **Day 12**: UI é«˜çº§æ„Ÿé‡æ„ï¼ˆCalm Tech + Soft Brutalismï¼‰
- **Day 13**:
  - ç«¯åˆ°ç«¯æµ‹è¯•
  - Bug ä¿®å¤ï¼ˆå¯¹è¯è®°å¿†ã€æ—¥æœŸéªŒè¯ã€æ•°æ®æŒä¹…åŒ–ï¼‰
  - ä»£ç è´¨é‡æå‡ï¼ˆESLintã€TypeScriptï¼‰
  - æ€§èƒ½ä¼˜åŒ–ï¼ˆä»£ç åˆ†å‰²ã€æ‡’åŠ è½½ï¼‰
  - Vercel ç”Ÿäº§éƒ¨ç½²

---

## ğŸ™ è‡´è°¢

- [Next.js](https://nextjs.org) - React æ¡†æ¶
- [Supabase](https://supabase.com) - å¼€æº Firebase æ›¿ä»£æ–¹æ¡ˆ
- [Dify.ai](https://dify.ai) - AI åº”ç”¨å¼€å‘å¹³å°
- [Vercel](https://vercel.com) - éƒ¨ç½²å¹³å°
- [Tailwind CSS](https://tailwindcss.com) - CSS æ¡†æ¶

---

## ğŸ“„ è®¸å¯è¯

MIT License

---

**Made with â¤ï¸ by PetBrain Team**

ğŸ¤– Powered by [Claude Code](https://claude.com/claude-code)
